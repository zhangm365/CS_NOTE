[toc]

# 动态内存分配

C++ 中，动态内存分配由一对运算符 **new** 和 **delete** 来完成。**new** 负责在动态内存中为对象分配空间并返回 一个指向该对象的指针。**delete** 接受一个动态对象的指针，销毁该对象，并释放与之关联的内存。

动态内存的使用不当会出现内存泄漏或产生引用非法内存的指针。

为了更安全地使用动态内存，新标准库提供了两种智能指针类型来管理动态对象。智能指针的行为类似常规指针，但重要的区别是它负责自动释放所指向的对象。

## 1. 智能指针：shared_ptr，unique_ptr

智能指针也是模板。两种智能指针的区别在于管理底层指针的方式不同。

shared_ptr 是允许多个指针指向同一对象，unique_ptr 是 "独占" 所指向的对象。他们定义在 **memory** 头文件内。

## (1) . shared_ptr 类

智能指针在创建时，必须提供指针可以指向的类型。

```c++
#include <memory>
// 定义智能指针, 默认初始化的智能指针中保存着一个空指针
shared_ptr<int> p;	// shared_ptr 可以指向 int 类型的对象
shared_ptr<string> ps;	// shared_ptr 可以指向 string 
```

