[toc]

# 对象的移动

------

## 1. 右值引用

新标准的一个最主要的特性是支持对象的移动而非拷贝对象的能力。在某些情况下，移动而非拷贝对象会大幅度提升性能。
标准库容器、`string`、`shared_ptr` 类既支持移动也支持拷贝，而 `IO` 类和 `unique_ptr` 类可以移动但不能拷贝。

为了支持移动操作，新标准引入了一种新的引用类型---**右值引用**。所谓右值引用就是必须绑定到右值的引用，通过 `&&` 来获得右值引用。
当一个对象被用作右值的时候，用的是对象的值（内容）；当对象被用作左值的时候，用的是对象的身份（在内存中的地址）。

返回左值引用的函数、赋值、下标、解引用和前置递增/递减运算符，都是返回左值的表达式的例子。因此，可以将左值引用绑定到此类表达式的结果上。
返回非引用的函数、算术、关系、位以及后置递增/递减运算符，都生成右值。

因此，左值具有持久的状态，而右值要么是字面常量，要么是在表达式求值过程中创建的临时对象。右值引用指向将要被销毁的对象。

## 2. 移动构造函数

为了支持移动操作，我们要定义 **移动构造函数** 和 **移动赋值运算符**。这两个成员类似对应的拷贝操作，但它们是从给定的对象中 "窃取" 资源而不是拷贝资源。

类似拷贝构造函数，移动构造函数的第一个参数是该类类型的一个引用。不用于拷贝构造函数的是，这个引用参数在移动构造函数中是一个右值引用。同时，与拷贝构造函数一样，任何额外的参数都必须有默认实参。移动构造函数将数据从其参数移动到新创建的对象中，