# 分区扩容

## 1. Ubuntu 查看分区

```bash
# 查看扩容前的分区大小
$ df -hl
Filesystem      Size  Used Avail Use% Mounted on
/dev/sda3       125G  109G   11G  92% /

$ lsblk 

```

## 2. 硬盘分区

```bash
# 硬盘分区：/dev/sdb
sudo fdisk /dev/sdb

# 格式化：-t ext4 指定新分区为 ext4 格式
sudo mkfs -t ext4 /dev/sdb
```

## 3. 扩容分区

```bash

# 扩容分区
$ sudo parted /dev/sda
# 查看分区容量
(parted) p free                                                           
Model: VMware Virtual disk (scsi)
Disk /dev/sda: 275GB
Sector size (logical/physical): 512B/512B
Partition Table: gpt
Disk Flags: 

Number  Start   End     Size    File system  Name                  Flags
        17.4kB  1049kB  1031kB  Free Space
 1      1049kB  2097kB  1049kB                                     bios_grub
 2      2097kB  540MB   538MB   fat32        EFI System Partition  boot, esp
 3      540MB   137GB   137GB   ext4
        137GB   275GB   137GB   Free Space
# 设置单位
(parted) unit s                                                           
(parted) p free                                                           
Model: VMware Virtual disk (scsi)
Disk /dev/sda: 536870912s
Sector size (logical/physical): 512B/512B
Partition Table: gpt
Disk Flags: 

Number  Start       End         Size        File system  Name                  Flags
        34s         2047s       2014s       Free Space
 1      2048s       4095s       2048s                                          bios_grub
 2      4096s       1054719s    1050624s    fat32        EFI System Partition  boot, esp
 3      1054720s    268433407s  267378688s  ext4
        268433408s  536870878s  268437471s  Free Space

# 对编号为 3 的分区进行扩容，即 /dev/sda3
(parted) resizepart 3                                                     
Warning: Partition /dev/sda3 is being used. Are you sure you want to continue?
Yes/No? yes
# 输入新空间的 End 位置                                                               
End?  [268433407s]? 536870878s                                           
(parted)                                                                  
(parted) p free
Model: VMware Virtual disk (scsi)
Disk /dev/sda: 536870912s
Sector size (logical/physical): 512B/512B
Partition Table: gpt
Disk Flags: 

Number  Start     End         Size        File system  Name                  Flags
        34s       2047s       2014s       Free Space
 1      2048s     4095s       2048s                                          bios_grub
 2      4096s     1054719s    1050624s    fat32        EFI System Partition  boot, esp
 3      1054720s  536870878s  535816159s  ext4

(parted) q
Information: You may need to update /etc/fstab.

```

## 4. 刷新分区

```bash
$ sudo resize2fs /dev/sda3

# 查看分区是否扩容成功
$ df -hl
/dev/sda3       251G  113G  128G  47% /

```

## 5. centos 分区扩容

```bash
# 1.查看磁盘情况（lsblk、fdisk -l、pvdisplay)
sudo lsblk
# 2.创建物理卷（pvcreate）
sudo pvcreate /dev/sdb
sudo pvs

# 根据物理卷创建卷组，ubuntu
sudo vgcreate ubuntu /dev/sdb

sudo vgs

# 3.将磁盘扩展到卷组（vgextend）
sudo vgextend centos /dev/sdb
# 4.扩展逻辑分区（lvextend）
# 根据自己的情况选择扩容到centos-root，还是centos-home逻辑分区，请修改注释
# 100%是将所有的磁盘空间扩容到指定分区，也可以根据需要进行调整比例
# 也支持指定大小比如10G等等（指定固定值时参数-l需要修改为-L)
sudo lvextend -l+100%FREE /dev/mapper/centos-root
#lvextend -l+100%FREE /dev/mapper/centos-home
# 5.使扩展生效（xfs_growfs）根据扩容的分区进行选择使用
# xfs_growfs /dev/mapper/centos-home
sudo xfs_growfs /dev/mapper/centos-root
# 6.查看（df -H）
df -H
```
