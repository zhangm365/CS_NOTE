# Protocol Buffers 基本知识

## 1. Protocol Buffers 是什么

`[Protocol Buffers](https://protobuf.dev/)` 是一种语言无关、平台无关、可扩展的序列化结构数据格式，它可用于（数据）通信协议、数据存储等领域。

1. 定义在 `.proto` 文件中，使用 `proto2` 或 `proto3` 语法；

2. 如下实例是 `addressbook.proto` 源码：

    ```proto
    syntax = "proto2";
    // package 声明，在 c++ 中会生成对应的命名空间 namespace
    package tutorial;

    message Person {
      optional string name = 1;
      optional int32 id = 2;
      optional string email = 3;
    }
    ```

3. 编译

    ```shell
    # -I: 指定源文件目录，如果没有该选项则默认是当前目录。
    # --cpp_out: 指定 C++ 类生成的输出目录，会在 $DST_DIR 生成两个文件：addressbook.pb.cc 和 addressbook.pb.h
    protoc -I=$SRC_DIR --cpp_out=$DST_DIR $SRC_DIR/addressbook.proto
    ```

  例如，上述命令通过 `protoc` 编译器将源文件 `addressbook.proto` 生成对应的代码 `addressbook.pb.cc` 和 `addressbook.pb.h`，其中 `addressbook.pb.h` 包含了 `Person` 类的定义，`addressbook.pb.cc` 包含了 `Person` 类的实现。
  具体可以看实例：[/protobuf/example/](https://github.com/protocolbuffers/protobuf/tree/main/examples)。
