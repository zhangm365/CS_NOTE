# `WAL` 机制

[`WAL`(Write-Ahead Logging)](https://www.postgresql.org/docs/current/wal-intro.html)是保证数据完整性的标准方法。

`WAL` 的核心思想是在将描述更改的 `WAL` 记录刷新到永久存储之后，才能写入这些修改的数据文件（数据表或索引所在文件）。基于上述原理，我们不需要在每次事务提交之后将数据页刷盘，因为在 `WAL` 记录刷新到永久存储之后，我们可以从 `WAL` 记录中重建未提交的数据文件来进行数据恢复。

## 1. `WAL` 优点

`WAL` 可以有效降低磁盘的写入次数，因为 `WAL` 文件成功刷盘后即证明事务已提交，不需要对每个事务修改的文件进行刷盘。

1. `WAL` 是顺序写，同步 `WAL` 文件的成本远低于刷新数据页的成本。
2. 支持在线备份和按时间点恢复。
